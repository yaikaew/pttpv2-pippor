<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="style.css" />
    <title>pippor & 2tee</title>
    <link rel="icon" href="assets/icons/icon.png" type="image/png">
</head>

<body>

    <!-- Navbar -->
    <div class="nav">
        <nav>
            <div class="nav__logo"><span><a href="index.html">PTTP</a></span></div>

            <div class="nav__toggle" id="nav-toggle">
                <i class="ri-menu-line"></i>
            </div>

            <ul class="nav__links" id="nav-menu">
                <li class="link"><a href="#profile">Profile</a></li>
                <li class="link"><a href="#schedule">Schedule</a></li>
                <li class="link"><a href="#discography">Discography</a></li>
                <li class="link"><a href="#filmography">Filmography</a></li>
                <li class="link"><a href="#brand">Brand Presenter</a></li>
                <li class="link"><a href="#awards">Awards</a></li>
                <li class="link"><a href="#shows">Shows</a></li>
            </ul>
        </nav>
    </div>

    <!-- Profile Section -->
    <section class="profile-section" id="profile">
        <div class="profile-card">
            <div class="profile-image">
                <img src="https://pbs.twimg.com/media/GuB0uEoWMAAHVIT?format=jpg&name=large" alt="Por">
            </div>
            <div class="profile-text">
                <h1><span>Por</span></h1>
                <h2>Suppakarn Jirachotikul</h2>
                <p>
                    Rising actor-singer who debuted as a main member of DVI after competing on LAZiCON. Notable role as Punlee in Your Sky Series; upcoming as Qin in Duang With You Series.
                </p>
                <div class="social-links">
                    <a href="https://x.com/porsuppakarn" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://www.instagram.com/porsuppakarn" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.tiktok.com/@porsuppakarn" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
                    <a href="https://weibo.com/u/7910928995" target="_blank"><i class="fa-brands fa-weibo"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Schedule Section -->
    <section class="schedule" id="schedule">
        <div class="schedule__container">
            <h2 class="section__title">Schedule</h2>
            <div class="schedule__grid" id="scheduleGridUpcoming"></div>
            <div class="view-all">
                <a href="schedule.html">View All Events</a>
            </div>
        </div>
    </section>

    <script>
        function loadScheduleData(range, elementId) {
            fetch(`/api/schedule?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                const allowedArtists = ["Por", "PTTP", "DEXX"];
                rows = rows.filter(row => allowedArtists.includes(row[2])); 

                const grid = document.getElementById(elementId);
                grid.innerHTML = rows.map(row => {
                    const [date, time, artist, title, location, info, img, link, outfit, keyword, tag, note, keylink, taglink, dateformat] = row;
                    return `
                        <div class="schedule__card">
                            <img src="${img}" alt="schedule" ${ link ? `onclick="openLink('${link}')"` : (info ? `onclick="openLink('${info}')"` : '')}/>
                            <div class="schedule__details">
                                ${title ? `<p class="schedule__title">${title}</p>` : ''}
                                
                                ${(keyword || tag) ? `
                                    <div class="keytag">
                                        ${keyword ? `<a href="${keylink}" class="schedule__tag" target="_blank" rel="noopener noreferrer">${keyword}</a>` : ''}
                                        ${tag ? `<a href="${taglink}" class="schedule__tag" target="_blank" rel="noopener noreferrer">${tag}</a>` : ''}
                                    </div>
                                ` : ''}
                                
                                <div class="datetimelocation">
                                    <div class="schedule__info">
                                        <i class="fa-solid fa-calendar-days"></i>
                                        <span>${date} ${time ? `| ${time}` : ''}</span>
                                    </div>
                                    ${location ? `
                                        <div class="schedule__info">
                                            <i class="fa-solid fa-location-dot"></i>
                                            <span>${location}</span>
                                        </div>
                                    ` : ''}
                                </div>

                                <div class="schedule__btn">
                                    ${
                                        link
                                            ? `<a href="${link}" target="_blank" class="streaming">Rerun</a>`
                                            : (info ? `<a href="${info}" target="_blank" class="streaming">info</a>` : '')
                                    }
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            });
        }

        loadScheduleData('upcoming!A2:N', 'scheduleGridUpcoming');
    </script>

    <!-- Discography Section -->
    <section class="discography" id="discography">
        <div class="discography__container">
            <h2 class="section__title">Discography</h2>
        </div>

        <div class="tab-menu" id="tabMenu"></div>
        <div class="tab-contents" id="tabContents"></div>
    </section>

    <script>
        function createDiscographyCard(row) {
            const [type, artist, date, song, artist2, link, link2, img, streaming, note, channel, imgchannel] = row;
            return `
            <div class="showcard" onclick="openLink('${link}')">
                <div class="thumbnail">
                    <img src="${img}" alt="video">
                </div>
                <div class="info">
                    <img src="${imgchannel}" alt="channel">
                    <div class="text">
                        <p class="title">${song}</p>
                        <p class="channel">${artist2} ${note ? ` • ${note}` : ''}</p>
                    </div>
                </div>
            </div>
            `;
        }

        function loadDiscographyData(range) {
            const tabMenu = document.getElementById("tabMenu");
            const tabContents = document.getElementById("tabContents");

            tabMenu.innerHTML = `<div class="loading-spinner"></div>`;
            tabContents.innerHTML = "";

            fetch(`/api/schedule?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                const allowedArtists = ["Por", "PTTP", "DEXX"];
                rows = rows.filter(row => allowedArtists.includes(row[1])); 

                if (rows.length === 0) {
                    tabContents.innerHTML = "<p>No data available</p>";
                    return;
                }

                const types = [...new Set(rows.map(r => r[0]))]; 

                tabMenu.innerHTML = types.map((type, idx) => 
                    `<span class="tab-link ${idx===0?'active':''}" data-tab="${type}">${type}</span>`
                ).join("");

                tabContents.innerHTML = types.map((type, idx) => {
                    const filtered = rows.filter(r => r[0] === type);
                    return `
                        <div id="${type}" class="tab-content ${idx===0?'active':''}">
                            <div class="discography__grid">
                                ${filtered.map(createDiscographyCard).join("")}
                            </div>
                        </div>`;
                }).join("");

                document.querySelectorAll(".tab-link").forEach(tab => {
                    tab.addEventListener("click", () => {
                        document.querySelectorAll(".tab-link").forEach(t => t.classList.remove("active"));
                        document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
                        tab.classList.add("active");
                        document.getElementById(tab.dataset.tab).classList.add("active");
                    });
                });
            })
            .catch(err => {
                console.error(err);
                tabContents.innerHTML = "<p>Error loading data</p>";
            });
        }

        loadDiscographyData("discography!A2:L");
    </script>

    <!-- Filmography Section -->
    <section class="film" id="filmography">
        <div class="film__container">
            <h2 class="section__title">Filmography</h2>
            <div class="film__grid">
                <div class="film__card">
                    <img src="https://pbs.twimg.com/media/GcjdDQYaMAIjOfF?format=jpg&name=4096x4096" alt="film" onclick="openLink('https://youtube.com/playlist?list=PLcTibKbv20S4l3tuUU0ydM9BzZEc0nrLm')"/>
                    <div class="film__details">
                        <p class="film__title">กี่หมื่นฟ้า Your Sky Series</p>
                        <div class="film__role">ป๋อ รับบท พันลี้ <i class="ri-star-fill"></i> ตี๋ตี๋ รับบท ใกล้ใจ <br/> Punlee by Por <i class="ri-star-fill"></i> Glaijai by TeeTee</div>
                        <div class="film__info">
                            <div class="status"><span>Year</span> 2025</div>
                            <div class="film_rerun">
                                <a href="http://s.iq.com/cvgpz" target="_blank" rel="noopener noreferrer">
                                    <button class="rerun">iQIYI</button>
                                </a>
                                <a href="https://youtube.com/playlist?list=PLcTibKbv20S4l3tuUU0ydM9BzZEc0nrLm" target="_blank" rel="noopener noreferrer">
                                    <button class="rerun">YouTube</button>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="film__card">
                    <img src="https://pbs.twimg.com/media/GmZg7Lhb0AAYn69?format=jpg&name=medium" alt="film" onclick="openLink('http://s.iq.com/YourSkyOfUs')"/>
                    <div class="film__details">
                        <p class="film__title">กี่หมื่นฟ้า Your Sky Of Us</p>
                        <div class="film__role">ป๋อ รับบท พันลี้ <i class="ri-star-fill"></i> ตี๋ตี๋ รับบท ใกล้ใจ <br/> Punlee by Por <i class="ri-star-fill"></i> Glaijai by TeeTee</div>
                        <div class="film__info">
                            <div class="status"><span>Year</span> 2025</div>
                            <div class="film_rerun">
                                <a href="http://s.iq.com/YourSkyOfUs" target="_blank" rel="noopener noreferrer">
                                    <button class="rerun">iQIYI</button>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="film__card">
                    <img src="https://pbs.twimg.com/media/GkPQY-oa0AAZaIa?format=jpg&name=4096x4096" alt="film" onclick="openLink('https://youtu.be/G7ExYljjGoo')"/>
                    <div class="film__details">
                        <p class="film__title">ด้วงกับเธอ Duang With You Series</p>
                        <div class="film__role">ตี๋ตี๋ รับบท ด้วง <i class="ri-star-fill"></i> ป๋อ รับบท ฉิน <br/> Duang by TeeTee <i class="ri-star-fill"></i> Qin by Por</div>
                        <div class="film__info">
                            <div class="status"><span>Coming Soon</span> </div>
                            <div class="film_rerun">
                                <a href="https://youtu.be/G7ExYljjGoo" target="_blank" rel="noopener noreferrer">
                                    <button class="rerun">PILOT</button>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="film__card">
                    <img src="https://pbs.twimg.com/media/GkPmh--WgAAapoX?format=jpg&name=4096x4096" alt="film" onclick="openLink('https://x.com/DomundiTV/status/1892609941485346900')"/>
                    <div class="film__details">
                        <p class="film__title">DMD SITCOM หอตัวดี</p>
                        <div class="film__role">#หอตัวดี</div>
                        <div class="film__info">
                            <div class="status"><span>Coming Soon</span> </div>
                            <div class="film_rerun">
                                <a href="https://x.com/DomundiTV/status/1892609941485346900" target="_blank" rel="noopener noreferrer">
                                    <button class="rerun">info</button>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Brand Presenter Section -->
    <section class="brand" id="brand">
        <div class="brand__container">
            <h2 class="section__title">Brand Presenter</h2>
            <div class="brand__grid" id="presenterGrid">
                <div class="loading-spinner"></div>
            </div>
        </div>
    </section>

    <script>
        function loadPresenterData(range, elementId) {
            const grid = document.getElementById(elementId);
            
            grid.innerHTML = '<div class="loading-spinner"></div>';

            fetch(`/api/schedule?range=${encodeURIComponent(range)}`)
            .then(res => {
                if (!res.ok) {
                    throw new Error('Network response was not ok');
                }
                return res.json();
            })
            .then(data => {
                let rows = data.values || [];

                const allowedArtists = ["Por", "PTTP", "DEXX"];
                rows = rows.filter(row => allowedArtists.includes(row[0])); 

                grid.innerHTML = rows.map(row => {
                    const [artist, date, brand, link, dmd, img] = row;
                    return `
                        <div class="brand__card" onclick="openLink('${dmd}')">
                            <img src="${img}" alt="${brand}" />
                            <div class="brand__details">
                                <p class="brand__title">${brand}</p>
                                <p class="brand__subtitle">Start: ${date}</p>
                            </div>
                        </div>
                    `;
                }).join('');
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
                grid.innerHTML = '<p>Error loading data</p>';
            });
        }
        loadPresenterData('presenter!A2:H', 'presenterGrid');
    </script>

    <!-- Awards Section -->
    <section class="awards" id="awards">
        <div class="awards__container">
            <h2 class="section__title">Awards</h2>
            <div class="awards__grid" id="awardsGrid">
                <div class="loading-spinner"></div>
            </div>
        </div>
    </section>

    <script>
        function loadAwardsData(range, elementId) {
            const grid = document.getElementById(elementId);
            
            grid.innerHTML = '<div class="loading-spinner"></div>';

            fetch(`/api/schedule?range=${encodeURIComponent(range)}`)
            .then(res => {
                if (!res.ok) {
                    throw new Error('Network response was not ok');
                }
                return res.json();
            })
            .then(data => {
                let rows = data.values || [];

                const allowedArtists = ["Por", "PTTP", "DEXX"];
                rows = rows.filter(row => allowedArtists.includes(row[0])); 

                grid.innerHTML = rows.map(row => {
                    const [artist, date, award, category, result, link, note, img] = row;

                    let resultHTML = '';
                    if (result === 'ได้รับรางวัล') {
                        resultHTML = `<p class="awards__result received">${result}</p>`;
                    } else if (result === 'เสนอชื่อเข้าชิง') {
                        resultHTML = `<p class="awards__result nominated">${result}</p>`;
                    } else {
                        resultHTML = `<p class="awards__result">${result}</p>`;
                    }

                    return `
                        <div class="awards__card" onclick="openLink('${link}')">
                            <img src="${img}" alt="" />
                            <div class="awards__details">
                                <p class="awards__title">${award}</p>
                                <p class="awards__subtitle">${category}</p>
                                ${resultHTML}
                            </div>
                        </div>
                    `;
                }).join('');
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
                grid.innerHTML = '<p>Error loading data</p>';
            });
        }
        loadAwardsData('awards!A2:H', 'awardsGrid');
    </script>

    <!-- Shows Section -->
    <section class="shows" id="shows">
        <div class="shows__container">
            <h2 class="section__title">Shows</h2>
        </div>

        <div class="tab-menu-2" id="tabMenu2"></div>
        <div class="tab-contents" id="tabContents2"></div>
    </section>

    <script>
        function createShowCard(row) {
            const [type, artist, date, title, link, id, thumbnail, channel, imgchannel, duration] = row;
            return `
                <div class="showcard" onclick="openLink('${link}')">
                    <div class="thumbnail">
                        <img src="${thumbnail}" alt="video">
                        <span class="badge">${duration}</span>
                    </div>
                    <div class="info">
                        <img src="${imgchannel}" alt="channel">
                        <div class="text">
                            <p class="title">${title}</p>
                            <p class="channel">${channel} • ${date}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function loadShowsData(range) {
            const tabMenu2 = document.getElementById("tabMenu2");
            const tabContents2 = document.getElementById("tabContents2");

            tabMenu2.innerHTML = `<div class="loading-spinner"></div>`;
            tabContents2.innerHTML = "";

            fetch(`/api/schedule?range=${encodeURIComponent(range)}`)
            .then(res => res.json())
            .then(data => {
                let rows = data.values || [];

                const allowedArtists = ["Por", "PTTP", "DEXX"];
                rows = rows.filter(r => allowedArtists.includes(r[1]));

                if (rows.length === 0) {
                    tabContents2.innerHTML = "<p>No data available</p>";
                    return;
                }

                const types = [...new Set(rows.map(r => r[0]))]; 

                tabMenu2.innerHTML = types.map((type, idx) => 
                    `<span class="tab-link-2 ${idx===0?'active':''}" data-tab="${type}">${type}</span>`
                ).join("");

                tabContents2.innerHTML = types.map((type, idx) => {
                    const filtered = rows.filter(r => r[0] === type);
                    return `
                        <div id="${type}" class="tab-content-2 ${idx===0?'active':''}">
                            <div class="shows__grid">
                                ${filtered.map(createShowCard).join("")}
                            </div>
                        </div>
                    `;
                }).join("");

                document.querySelectorAll(".tab-link-2").forEach(tab => {
                    tab.addEventListener("click", () => {
                        document.querySelectorAll(".tab-link-2").forEach(t => t.classList.remove("active"));
                        document.querySelectorAll(".tab-content-2").forEach(c => c.classList.remove("active"));
                        tab.classList.add("active");
                        document.getElementById(tab.dataset.tab).classList.add("active");
                    });
                });
            })
            .catch(err => {
                console.error(err);
                tabContents2.innerHTML = "<p>Error loading data</p>";
            });
        }

        loadShowsData("shows!A2:J");
    </script>

    <footer class="footer">
        <div class="footer__bar">
            &copy; Made with Love | By <a href="https://x.com/yorkorrrr">yorkor</a><br/>
        </div>
    </footer>

    <script>
        // ไฮไลท์เมนูขณะเลื่อน
        document.addEventListener("DOMContentLoaded", () => {
            const sections = document.querySelectorAll("section[id]");
            const navLinks = document.querySelectorAll(".nav__links li a");

            const observer = new IntersectionObserver(
                (entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            navLinks.forEach(link => {
                                link.classList.remove("active");
                                if (link.getAttribute("href") === `#${entry.target.id}`) {
                                    link.classList.add("active");
                                }
                            });
                        }
                    });
                },
                {
                    threshold: 0.3, // เห็น section 30% ถึงจะ active
                }
            );

            sections.forEach(section => {
                observer.observe(section);
            });
        });
    </script>

    <script src="script.js"></script>

</body>

</html>